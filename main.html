<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script defer src="api.js"></script>
    <title>Defender cental</title>
</head>

<body>
    <!-- Testing VirusTotalAPI -->
    <h1>Testing VirusTotal API</h1>
    <form id="scanForm">
        <label for="urlInput">Enter URL to scan:</label>
        <input type="text" id="urlInput" required>
        <button type="button" onclick="scanURL()">Scan</button>
      </form>
    
      <div id="resultContainer" style="display: none;">
        <h2>Scan Results</h2>
        <pre id="scanResults"></pre>
      </div>
    
      <script>
        const apiKey = '3cafe6ff9ae09edcb22bd5529609efc1eca8209943277c80ab99cd70a4cf684f';
    
        function scanURL() {
          const urlInput = document.getElementById('urlInput').value;
          const apiUrl = 'https://www.virustotal.com/api/v3/urls';
          const options = {
            method: 'POST',
            headers: {
              'x-apikey': apiKey,
              'content-type': 'application/x-www-form-urlencoded'
            },
            body: new URLSearchParams({ url: urlInput })
          };
    
          // Perform URL scan
          fetch(apiUrl, options)
            .then(response => response.json())
            .then(response => {
              const analysisId = response.data.id;
              // Display the results
              displayResults(analysisId);
            })
            .catch(err => console.error(err));
        }
    
        function displayResults(analysisId) {
          const resultContainer = document.getElementById('resultContainer');
          const resultsElement = document.getElementById('scanResults');
          const apiUrl = `https://www.virustotal.com/api/v3/analyses/${analysisId}`;
    
          // Fetch analysis results
          fetch(apiUrl, {
            method: 'GET',
            headers: { 'x-apikey': apiKey, 'accept': 'application/json' }
          })
            .then(response => response.json())
            .then(response => {
              // Display the analysis results
              resultsElement.textContent = JSON.stringify(response, null, 2);
              resultContainer.style.display = 'block';
            })
            .catch(err => console.error(err));
        }
      </script>
    </body>
    </html>